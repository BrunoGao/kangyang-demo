# åº·å…»AIæ£€æµ‹ç³»ç»Ÿ - é˜¿é‡Œäº‘å®¹å™¨é•œåƒéƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡éƒ¨ç½²åº·å…»AIæ£€æµ‹ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨å®Œå…¨å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ”¯æŒä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é˜¿é‡Œäº‘å®¹å™¨é•œåƒä»“åº“                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ljwx-ky-mysql:1.0.1         â€¢ ljwx-ky-backend:1.0.1     â”‚
â”‚  â€¢ ljwx-ky-frontend:1.0.1      â€¢ ljwx-ky-edge-controller:1.0.1 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æœ¬åœ°éƒ¨ç½²ç¯å¢ƒ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   å‰ç«¯ç®¡ç†   â”‚  â”‚   åç«¯API   â”‚  â”‚   æ•°æ®åº“    â”‚         â”‚
â”‚  â”‚   :80       â”‚  â”‚   :8080     â”‚  â”‚   :3306     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ è¾¹ç¼˜æ§åˆ¶å™¨1  â”‚  â”‚ è¾¹ç¼˜æ§åˆ¶å™¨2  â”‚  â”‚   ç›‘æ§ç³»ç»Ÿ   â”‚         â”‚
â”‚  â”‚   :8084     â”‚  â”‚   :8085     â”‚  â”‚   :9092     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### å‰ç½®æ¡ä»¶

1. **æ“ä½œç³»ç»Ÿ**: Linux (Ubuntu 18.04+, CentOS 7+)
2. **Docker**: >= 20.10.0
3. **Docker Compose**: >= 2.0.0
4. **å†…å­˜**: æœ€å°‘ 8GB RAM
5. **ç£ç›˜**: æœ€å°‘ 50GB å¯ç”¨ç©ºé—´
6. **ç½‘ç»œ**: å¯è®¿é—®äº’è”ç½‘

### ä¸€é”®éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/BrunoGao/kangyang-demo.git
cd kangyang-demo/deployment

# 2. æ‰§è¡Œéƒ¨ç½²è„šæœ¬
./deploy-aliyun.sh
```

## ğŸ“¦ å®¹å™¨é•œåƒè¯¦æƒ…

### é•œåƒåˆ—è¡¨

| æœåŠ¡åç§° | é•œåƒåœ°å€ | ç‰ˆæœ¬ | ç”¨é€” |
|---------|----------|------|------|
| MySQLæ•°æ®åº“ | `crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-mysql:1.0.1` | 1.0.1 | æ•°æ®å­˜å‚¨ |
| åç«¯API | `crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-backend:1.0.1` | 1.0.1 | ä¸šåŠ¡é€»è¾‘ |
| å‰ç«¯ç®¡ç† | `crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-frontend:1.0.1` | 1.0.1 | ç”¨æˆ·ç•Œé¢ |
| è¾¹ç¼˜æ§åˆ¶å™¨ | `crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-edge-controller:1.0.1` | 1.0.1 | AIæ£€æµ‹ |

### é•œåƒç‰¹æ€§

#### MySQLæ•°æ®åº“é•œåƒ
- **åŸºç¡€é•œåƒ**: mysql:8.0
- **é¢„é…ç½®**: å­—ç¬¦é›†utf8mb4ï¼Œæ—¶åŒºAsia/Shanghai
- **åˆå§‹åŒ–**: è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨å’Œç¤ºä¾‹æ•°æ®
- **é…ç½®ä¼˜åŒ–**: é’ˆå¯¹AIæ£€æµ‹åœºæ™¯çš„æ€§èƒ½ä¼˜åŒ–

#### åç«¯APIé•œåƒ  
- **åŸºç¡€é•œåƒ**: openjdk:17-jdk-slim
- **æ¡†æ¶**: Spring Boot 3.2
- **ç‰¹æ€§**: RESTful API, å¾®ä¿¡å‘Šè­¦, è¾¹ç¼˜è®¾å¤‡ç®¡ç†
- **ç›‘æ§**: é›†æˆPrometheusæŒ‡æ ‡

#### å‰ç«¯ç®¡ç†é•œåƒ
- **åŸºç¡€é•œåƒ**: nginx:alpine
- **æ¡†æ¶**: Vue3 + Element Plus
- **ç‰¹æ€§**: å“åº”å¼è®¾è®¡, EChartså›¾è¡¨, å®æ—¶ç›‘æ§
- **ä¼˜åŒ–**: Gzipå‹ç¼©, èµ„æºç¼“å­˜

#### è¾¹ç¼˜æ§åˆ¶å™¨é•œåƒ
- **åŸºç¡€é•œåƒ**: python:3.11-slim
- **AIæ¡†æ¶**: OpenCV + è‡ªä¸»ç®—æ³•
- **ç‰¹æ€§**: 22è·¯è§†é¢‘å¹¶å‘, è·Œå€’/ç«ç„°/çƒŸé›¾æ£€æµ‹
- **æ€§èƒ½**: ä¼˜åŒ–å†…å­˜ä½¿ç”¨, GPUåŠ é€Ÿæ”¯æŒ

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| TZ | Asia/Shanghai | æ—¶åŒºè®¾ç½® |
| MYSQL_ROOT_PASSWORD | kangyang123 | MySQL rootå¯†ç  |
| MYSQL_PASSWORD | kangyang_pass | ä¸šåŠ¡ç”¨æˆ·å¯†ç  |
| REDIS_PASSWORD | kangyang_redis_pass | Rediså¯†ç  |
| GF_SECURITY_ADMIN_PASSWORD | kangyang_grafana_pass | Grafanaå¯†ç  |

### ç«¯å£æ˜ å°„

| æœåŠ¡ | å†…éƒ¨ç«¯å£ | å¤–éƒ¨ç«¯å£ | åè®® |
|------|----------|----------|------|
| å‰ç«¯ç®¡ç† | 80 | 80, 3000 | HTTP |
| åç«¯API | 8080 | 8080 | HTTP |
| MySQL | 3306 | 3306 | TCP |
| Redis | 6379 | 6379 | TCP |
| è¾¹ç¼˜æ§åˆ¶å™¨1 | 8084 | 8084 | HTTP |
| è¾¹ç¼˜æ§åˆ¶å™¨2 | 8084 | 8085 | HTTP |
| Prometheus | 9090 | 9092 | HTTP |
| Grafana | 3000 | 3001 | HTTP |

### æ•°æ®å·æŒ‚è½½

```yaml
volumes:
  - mysql-data:/var/lib/mysql              # MySQLæ•°æ®
  - redis-data:/data                       # Redisæ•°æ®
  - edge-data:/data/edge-controller        # è¾¹ç¼˜æ•°æ®
  - ./logs/mysql:/var/log/mysql           # MySQLæ—¥å¿—
  - ./logs/edge-1:/app/logs               # è¾¹ç¼˜æ§åˆ¶å™¨1æ—¥å¿—
  - ./logs/edge-2:/app/logs               # è¾¹ç¼˜æ§åˆ¶å™¨2æ—¥å¿—
  - ./mp4:/app/mp4                        # æµ‹è¯•è§†é¢‘æ–‡ä»¶
```

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

å¦‚æœéœ€è¦æ‰‹åŠ¨éƒ¨ç½²ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. ç™»å½•é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡

```bash
docker login --username=brunogao crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com
# è¾“å…¥å¯†ç : admin123
```

### 2. æ‹‰å–é•œåƒ

```bash
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-mysql:1.0.1
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-backend:1.0.1
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-frontend:1.0.1
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-edge-controller:1.0.1
```

### 3. åˆ›å»ºç›®å½•ç»“æ„

```bash
mkdir -p logs/{mysql,edge-1,edge-2}
mkdir -p data/{prometheus,grafana}
mkdir -p monitoring/grafana/provisioning/{dashboards,datasources}
mkdir -p mp4
```

### 4. å¯åŠ¨æœåŠ¡

```bash
docker-compose -f docker-compose-aliyun.yml up -d
```

## ğŸ“Š æœåŠ¡ç›‘æ§

### PrometheusæŒ‡æ ‡

ç³»ç»Ÿé›†æˆäº†Prometheusç›‘æ§ï¼Œå¯ä»¥ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

- **ç³»ç»ŸæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œä½¿ç”¨ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: APIè¯·æ±‚é‡ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **AIæŒ‡æ ‡**: æ£€æµ‹å¸§ç‡ã€æ£€æµ‹å‡†ç¡®ç‡ã€äº‹ä»¶æ•°é‡
- **æ•°æ®åº“æŒ‡æ ‡**: è¿æ¥æ•°ã€æŸ¥è¯¢æ€§èƒ½ã€å­˜å‚¨ä½¿ç”¨é‡

### Grafanaä»ªè¡¨æ¿

é¢„é…ç½®çš„Grafanaä»ªè¡¨æ¿åŒ…å«ï¼š

1. **ç³»ç»Ÿæ€»è§ˆ**: æ•´ä½“è¿è¡ŒçŠ¶æ€å’Œå…³é”®æŒ‡æ ‡
2. **è¾¹ç¼˜è®¾å¤‡**: ä¸¤ä¸ªè¾¹ç¼˜æ§åˆ¶å™¨çš„è¯¦ç»†ç›‘æ§
3. **æ£€æµ‹ç»Ÿè®¡**: è·Œå€’ã€ç«ç„°ã€çƒŸé›¾æ£€æµ‹ç»Ÿè®¡
4. **æ€§èƒ½åˆ†æ**: å„ç»„ä»¶æ€§èƒ½åˆ†æå’Œè¶‹åŠ¿
5. **å‘Šè­¦è®°å½•**: å†å²å‘Šè­¦å’Œå¤„ç†æƒ…å†µ

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose-aliyun.yml ps

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose-aliyun.yml logs -f [æœåŠ¡å]

# é‡å¯æœåŠ¡
docker-compose -f docker-compose-aliyun.yml restart [æœåŠ¡å]
```

#### 2. é•œåƒæ‹‰å–å¤±è´¥

```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com

# é‡æ–°ç™»å½•
docker login --username=brunogao crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com

# æ‰‹åŠ¨æ‹‰å–é•œåƒ
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-edge-controller:1.0.1
```

#### 3. æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥MySQLå®¹å™¨çŠ¶æ€
docker exec -it kangyang-mysql mysqladmin ping -u root -pkangyang123

# é‡ç½®æ•°æ®åº“
docker-compose -f docker-compose-aliyun.yml down
docker volume rm deployment_mysql-data
docker-compose -f docker-compose-aliyun.yml up -d mysql
```

#### 4. ç«¯å£å†²çª

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :80
netstat -tlnp | grep :8080

# ä¿®æ”¹ç«¯å£æ˜ å°„
vi docker-compose-aliyun.yml
# ä¿®æ”¹portsé…ç½®ï¼Œå¦‚ "8081:8080"
```

### æ—¥å¿—åˆ†æ

#### é‡è¦æ—¥å¿—ä½ç½®

```bash
# MySQLæ—¥å¿—
tail -f logs/mysql/error.log

# è¾¹ç¼˜æ§åˆ¶å™¨æ—¥å¿—
tail -f logs/edge-1/app.log
tail -f logs/edge-2/app.log

# Docker Composeæ—¥å¿—
docker-compose -f docker-compose-aliyun.yml logs -f --tail=100
```

## ğŸ”§ æ€§èƒ½è°ƒä¼˜

### ç³»ç»Ÿä¼˜åŒ–å»ºè®®

#### 1. å†…å­˜ä¼˜åŒ–

```yaml
# è°ƒæ•´MySQLå†…å­˜é…ç½®
environment:
  - MYSQL_INNODB_BUFFER_POOL_SIZE=2G
  - MYSQL_KEY_BUFFER_SIZE=64M
```

#### 2. ç£ç›˜ä¼˜åŒ–

```bash
# ä½¿ç”¨SSDå­˜å‚¨
# å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
find logs/ -name "*.log" -mtime +7 -delete

# æ•°æ®åº“å®šæœŸå¤‡ä»½å’Œæ¸…ç†
docker exec kangyang-mysql mysqldump -u root -pkangyang123 kangyang_db > backup.sql
```

#### 3. ç½‘ç»œä¼˜åŒ–

```yaml
# ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ
networks:
  kangyang-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16
```

## ğŸ”„ æ›´æ–°å‡çº§

### ç‰ˆæœ¬æ›´æ–°

```bash
# 1. æ‹‰å–æ–°ç‰ˆæœ¬é•œåƒ
docker pull crpi-yilnm6upy4pmbp67.cn-shenzhen.personal.cr.aliyuncs.com/ljwx-ky/ljwx-ky-edge-controller:1.0.2

# 2. æ›´æ–°docker-composeæ–‡ä»¶ä¸­çš„ç‰ˆæœ¬å·
vi docker-compose-aliyun.yml

# 3. æ»šåŠ¨æ›´æ–°
docker-compose -f docker-compose-aliyun.yml up -d --no-deps edge-controller-1
docker-compose -f docker-compose-aliyun.yml up -d --no-deps edge-controller-2
```

### æ•°æ®å¤‡ä»½

```bash
# å¤‡ä»½æ•°æ®åº“
docker exec kangyang-mysql mysqldump -u root -pkangyang123 --all-databases > backup_$(date +%Y%m%d_%H%M%S).sql

# å¤‡ä»½Redis
docker exec kangyang-redis redis-cli --rdb /data/dump_$(date +%Y%m%d_%H%M%S).rdb

# å¤‡ä»½é…ç½®æ–‡ä»¶
tar -czf config_backup_$(date +%Y%m%d_%H%M%S).tar.gz monitoring/ logs/ data/
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼

- **é¡¹ç›®ä»“åº“**: https://github.com/BrunoGao/kangyang-demo
- **é—®é¢˜æŠ¥å‘Š**: https://github.com/BrunoGao/kangyang-demo/issues

### ç³»ç»Ÿè¦æ±‚

- **æœ€ä½é…ç½®**: 4æ ¸CPU + 8GB RAM + 50GBå­˜å‚¨
- **æ¨èé…ç½®**: 8æ ¸CPU + 16GB RAM + 100GB SSD
- **ç”Ÿäº§é…ç½®**: 16æ ¸CPU + 32GB RAM + 500GB SSD + GPUåŠ é€Ÿ

### è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦æƒ…è¯·å‚è€ƒé¡¹ç›®æ ¹ç›®å½•çš„LICENSEæ–‡ä»¶ã€‚

---

**åº·å…»AIæ£€æµ‹ç³»ç»Ÿ** - è®©ç§‘æŠ€å®ˆæŠ¤æ¯ä¸€ä½è€äººçš„å®‰å…¨ä¸å¥åº· ğŸ’™