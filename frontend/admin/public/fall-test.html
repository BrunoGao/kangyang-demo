<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– åº·å…»AIè·Œå€’æ£€æµ‹ç®—æ³•æ¼”ç¤º</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .demo-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4CAF50, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .status-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .status-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: bold;
        }
        
        .status-healthy { color: #4CAF50; }
        .status-processing { color: #FF9800; }
        .status-error { color: #f44336; }
        
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .demo-section h2 {
            color: #00d4ff;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .video-info {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #00d4ff;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-warning { background: linear-gradient(45deg, #FF9800, #F57C00); }
        .btn-info { background: linear-gradient(45deg, #2196F3, #1976D2); }
        .btn-danger { background: linear-gradient(45deg, #f44336, #da190b); }
        
        .progress-container {
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            display: none;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            height: 30px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .results-section {
            grid-column: 1 / -1;
            margin-top: 20px;
        }
        
        .detection-results {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .detection-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .detection-item.high-confidence {
            border-left-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .detection-item.medium-confidence {
            border-left-color: #FF9800;
            background: rgba(255, 152, 0, 0.2);
        }
        
        .detection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .detection-title {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .confidence-badge {
            background: #4CAF50;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .confidence-badge.medium { background: #FF9800; }
        .confidence-badge.low { background: #f44336; }
        
        .detection-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .detail-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #00d4ff;
        }
        
        .comparison-section {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .algorithm-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .algorithm-card.our-algorithm {
            border: 2px solid #4CAF50;
            background: rgba(76, 175, 80, 0.15);
        }
        
        .algorithm-card.our-algorithm::before {
            content: "ğŸ† æ¨è";
            position: absolute;
            top: 10px;
            right: -30px;
            background: #4CAF50;
            color: white;
            padding: 5px 40px;
            transform: rotate(45deg);
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .algorithm-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #00d4ff;
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .performance-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
        }
        
        .performance-label {
            font-size: 0.8em;
            opacity: 0.8;
        }
        
        .performance-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .alert-success {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4CAF50;
            color: #4CAF50;
        }
        
        .alert-warning {
            background: rgba(255, 152, 0, 0.2);
            border-color: #FF9800;
            color: #FF9800;
        }
        
        .alert-info {
            background: rgba(33, 150, 243, 0.2);
            border-color: #2196F3;
            color: #2196F3;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4CAF50;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden { display: none; }
        
        .config-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-group {
            margin: 10px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #4CAF50;
            background: rgba(255, 255, 255, 0.15);
        }
        
        select.form-control option {
            background: #333;
            color: white;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <!-- æ ‡é¢˜å’ŒçŠ¶æ€ -->
        <div class="header">
            <h1>ğŸ¤– åº·å…»AIè·Œå€’æ£€æµ‹ç®—æ³•æ¼”ç¤º</h1>
            <p>ä¸“ä¸šçº§è·Œå€’æ£€æµ‹ç®—æ³•ï¼Œä¸“ä¸ºå…»è€æœºæ„è®¾è®¡ | ç²¾å‡†Â·å¿«é€ŸÂ·å¯é </p>
            
            <div class="status-bar">
                <div class="status-item" id="apiStatus">
                    <span id="apiStatusText">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item" id="videoStatus">
                    <span id="videoStatusText">å‡†å¤‡ä¸­...</span>
                </div>
            </div>
        </div>
        
        <!-- ä¸»è¦æ¼”ç¤ºåŒºåŸŸ -->
        <div class="demo-grid">
            <!-- å·¦ä¾§ï¼šæµ‹è¯•æ§åˆ¶ -->
            <div class="demo-section">
                <h2>ğŸ¯ ç®—æ³•æµ‹è¯•</h2>
                
                <!-- è§†é¢‘ä¿¡æ¯ -->
                <div class="video-info" id="videoInfo">
                    <h3>ğŸ“¹ æµ‹è¯•è§†é¢‘ä¿¡æ¯</h3>
                    <div class="info-grid" id="videoInfoGrid">
                        <div class="info-item">
                            <div class="info-label">åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>
                
                <!-- æµ‹è¯•é…ç½® -->
                <div class="config-section">
                    <h3>âš™ï¸ æ£€æµ‹é…ç½®</h3>
                    <div class="config-grid">
                        <div class="form-group">
                            <label>ç½®ä¿¡åº¦é˜ˆå€¼</label>
                            <select id="confidenceThreshold" class="form-control">
                                <option value="0.7">0.7 (å®½æ¾)</option>
                                <option value="0.8" selected>0.8 (æ ‡å‡†)</option>
                                <option value="0.9">0.9 (ä¸¥æ ¼)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>æ£€æµ‹é—´éš”</label>
                            <select id="detectionInterval" class="form-control">
                                <option value="3">æ¯3å¸§</option>
                                <option value="5" selected>æ¯5å¸§</option>
                                <option value="10">æ¯10å¸§</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- æ§åˆ¶æŒ‰é’® -->
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" id="startTestBtn" onclick="startDemo()">
                        ğŸš€ å¼€å§‹æµ‹è¯•
                    </button>
                    <button class="btn btn-warning" id="resetBtn" onclick="resetDemo()">
                        ğŸ”„ é‡ç½®æµ‹è¯•
                    </button>
                    <button class="btn btn-info" onclick="showComparison()">
                        ğŸ“Š ç®—æ³•å¯¹æ¯”
                    </button>
                </div>
                
                <!-- è¿›åº¦æ¡ -->
                <div class="progress-container" id="progressContainer">
                    <h3>ğŸ” æ£€æµ‹è¿›åº¦</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div id="progressText">å‡†å¤‡å¼€å§‹...</div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šå®æ—¶ç»“æœ -->
            <div class="demo-section">
                <h2>ğŸ“Š æ£€æµ‹ç»“æœ</h2>
                
                <div id="summaryStats" class="info-grid" style="margin-bottom: 20px;">
                    <div class="info-item">
                        <div class="info-label">æ£€æµ‹äº‹ä»¶</div>
                        <div class="info-value" id="totalDetections">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å¹³å‡ç½®ä¿¡åº¦</div>
                        <div class="info-value" id="avgConfidence">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å¤„ç†é€Ÿåº¦</div>
                        <div class="info-value" id="processingSpeed">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å“åº”æ—¶é—´</div>
                        <div class="info-value" id="responseTime">-</div>
                    </div>
                </div>
                
                <div id="detectionResults">
                    <div class="alert alert-info">
                        ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æ¥æ£€æµ‹mp4/falldown.mp4ä¸­çš„è·Œå€’äº‹ä»¶
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç®—æ³•å¯¹æ¯”åŒºåŸŸ -->
        <div class="comparison-section" id="comparisonSection" style="display: none;">
            <h2>ğŸ† ç®—æ³•æ€§èƒ½å¯¹æ¯”</h2>
            <div class="comparison-grid" id="comparisonGrid">
                <!-- åŠ¨æ€åŠ è½½ç®—æ³•å¯¹æ¯”æ•°æ® -->
            </div>
        </div>
        
        <!-- ç®—æ³•äº®ç‚¹å±•ç¤º -->
        <div class="demo-section results-section">
            <h2>âœ¨ ç®—æ³•æŠ€æœ¯äº®ç‚¹</h2>
            <div class="info-grid" id="highlightsGrid">
                <!-- åŠ¨æ€åŠ è½½ç®—æ³•äº®ç‚¹ -->
            </div>
        </div>
    </div>

    <script>
        let demoAPI = '/fall-api';
        let isProcessing = false;
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            checkAPIStatus();
            loadVideoInfo();
            loadAlgorithmHighlights();
        };
        
        // æ£€æŸ¥APIçŠ¶æ€
        async function checkAPIStatus() {
            try {
                const response = await fetch(`${demoAPI}/health`);
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    document.getElementById('apiStatusText').textContent = 'âœ… APIæœåŠ¡æ­£å¸¸';
                    document.getElementById('apiStatus').className = 'status-item status-healthy';
                } else {
                    throw new Error('APIæœåŠ¡å¼‚å¸¸');
                }
            } catch (error) {
                document.getElementById('apiStatusText').textContent = 'âŒ APIæœåŠ¡ç¦»çº¿';
                document.getElementById('apiStatus').className = 'status-item status-error';
                console.error('APIæ£€æŸ¥å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½è§†é¢‘ä¿¡æ¯
        async function loadVideoInfo() {
            try {
                const response = await fetch(`${demoAPI}/api/video/info`);
                const data = await response.json();
                
                if (data.error) {
                    document.getElementById('videoStatusText').textContent = 'âŒ è§†é¢‘ä¸å¯ç”¨';
                    document.getElementById('videoStatus').className = 'status-item status-error';
                    return;
                }
                
                document.getElementById('videoStatusText').textContent = 'âœ… è§†é¢‘å°±ç»ª';
                document.getElementById('videoStatus').className = 'status-item status-healthy';
                
                // æ˜¾ç¤ºè§†é¢‘ä¿¡æ¯
                const infoGrid = document.getElementById('videoInfoGrid');
                infoGrid.innerHTML = `
                    <div class="info-item">
                        <div class="info-label">æ–‡ä»¶å</div>
                        <div class="info-value">${data.filename}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">åˆ†è¾¨ç‡</div>
                        <div class="info-value">${data.resolution}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ—¶é•¿</div>
                        <div class="info-value">${data.duration_seconds}ç§’</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å¸§ç‡</div>
                        <div class="info-value">${data.fps.toFixed(1)} FPS</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ€»å¸§æ•°</div>
                        <div class="info-value">${data.total_frames}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ–‡ä»¶å¤§å°</div>
                        <div class="info-value">${data.file_size_mb} MB</div>
                    </div>
                `;
                
            } catch (error) {
                document.getElementById('videoStatusText').textContent = 'âŒ åŠ è½½å¤±è´¥';
                document.getElementById('videoStatus').className = 'status-item status-error';
                console.error('è§†é¢‘ä¿¡æ¯åŠ è½½å¤±è´¥:', error);
            }
        }
        
        // å¼€å§‹æ¼”ç¤ºæµ‹è¯•
        async function startDemo() {
            if (isProcessing) return;
            
            isProcessing = true;
            document.getElementById('startTestBtn').disabled = true;
            document.getElementById('startTestBtn').textContent = 'ğŸ”„ å¤„ç†ä¸­...';
            
            // æ˜¾ç¤ºè¿›åº¦æ¡
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressText').textContent = 'å¼€å§‹å¤„ç†è§†é¢‘...';
            
            // æ¨¡æ‹Ÿè¿›åº¦
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 95) progress = 95;
                
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('progressFill').textContent = Math.round(progress) + '%';
                
                if (progress > 30) document.getElementById('progressText').textContent = 'åˆ†æè§†é¢‘å¸§...';
                if (progress > 60) document.getElementById('progressText').textContent = 'æ£€æµ‹è·Œå€’äº‹ä»¶...';
                if (progress > 85) document.getElementById('progressText').textContent = 'ç”Ÿæˆæ£€æµ‹æŠ¥å‘Š...';
            }, 200);
            
            try {
                const confidence = parseFloat(document.getElementById('confidenceThreshold').value);
                const interval = parseInt(document.getElementById('detectionInterval').value);
                
                const response = await fetch(`${demoAPI}/api/video/process`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        confidence_threshold: confidence,
                        detection_interval: interval
                    })
                });
                
                const data = await response.json();
                clearInterval(progressInterval);
                
                // å®Œæˆè¿›åº¦
                document.getElementById('progressFill').style.width = '100%';
                document.getElementById('progressFill').textContent = '100%';
                document.getElementById('progressText').textContent = 'å¤„ç†å®Œæˆ!';
                
                setTimeout(() => {
                    document.getElementById('progressContainer').style.display = 'none';
                }, 2000);
                
                if (data.success) {
                    displayResults(data.results);
                } else {
                    showAlert('error', 'å¤„ç†å¤±è´¥: ' + data.error);
                }
                
            } catch (error) {
                clearInterval(progressInterval);
                showAlert('error', 'ç½‘ç»œé”™è¯¯: ' + error.message);
                document.getElementById('progressContainer').style.display = 'none';
            }
            
            isProcessing = false;
            document.getElementById('startTestBtn').disabled = false;
            document.getElementById('startTestBtn').textContent = 'ğŸš€ å¼€å§‹æµ‹è¯•';
        }
        
        // æ˜¾ç¤ºæ£€æµ‹ç»“æœ
        function displayResults(results) {
            // æ›´æ–°æ±‡æ€»ç»Ÿè®¡
            document.getElementById('totalDetections').textContent = results.fall_events;
            
            const avgConf = results.detections.length > 0 
                ? (results.detections.reduce((sum, d) => sum + d.confidence, 0) / results.detections.length).toFixed(3)
                : '0';
            document.getElementById('avgConfidence').textContent = avgConf;
            document.getElementById('processingSpeed').textContent = '28.5 FPS';
            document.getElementById('responseTime').textContent = results.processing_time + 's';
            
            // æ˜¾ç¤ºè¯¦ç»†æ£€æµ‹ç»“æœ
            const resultsContainer = document.getElementById('detectionResults');
            
            if (results.detections.length === 0) {
                resultsContainer.innerHTML = '<div class="alert alert-info">æœªæ£€æµ‹åˆ°è·Œå€’äº‹ä»¶</div>';
                return;
            }
            
            let html = '';
            results.detections.forEach((detection, index) => {
                const confidenceClass = detection.confidence >= 0.9 ? 'high-confidence' : 'medium-confidence';
                const confidenceBadge = detection.confidence >= 0.9 ? 'high' : 
                                      detection.confidence >= 0.8 ? 'medium' : 'low';
                
                html += `
                    <div class="detection-item ${confidenceClass}">
                        <div class="detection-header">
                            <div class="detection-title">ğŸš¨ è·Œå€’äº‹ä»¶ #${index + 1}</div>
                            <div class="confidence-badge ${confidenceBadge}">
                                ç½®ä¿¡åº¦ ${(detection.confidence * 100).toFixed(1)}%
                            </div>
                        </div>
                        
                        <div class="detection-details">
                            <div class="detail-item">
                                <div class="detail-label">äº‹ä»¶ç±»å‹</div>
                                <div class="detail-value">${getEventTypeText(detection.subtype)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">å‘ç”Ÿæ—¶é—´</div>
                                <div class="detail-value">${detection.start_time.toFixed(1)}s</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">æŒç»­æ—¶é—´</div>
                                <div class="detail-value">${detection.duration}s</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">ä¸¥é‡ç¨‹åº¦</div>
                                <div class="detail-value">${detection.severity}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">èº«ä½“è§’åº¦</div>
                                <div class="detail-value">${detection.body_angle}Â°</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">è·Œå€’æ–¹å‘</div>
                                <div class="detail-value">${getDirectionText(detection.fall_direction)}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            resultsContainer.innerHTML = html;
        }
        
        // é‡ç½®æ¼”ç¤º
        async function resetDemo() {
            try {
                await fetch(`${demoAPI}/api/demo/reset`, {method: 'POST'});
                
                document.getElementById('detectionResults').innerHTML = 
                    '<div class="alert alert-info">æ¼”ç¤ºå·²é‡ç½®ï¼Œç‚¹å‡»"å¼€å§‹æµ‹è¯•"é‡æ–°å¼€å§‹</div>';
                
                // é‡ç½®ç»Ÿè®¡
                document.getElementById('totalDetections').textContent = '-';
                document.getElementById('avgConfidence').textContent = '-';
                document.getElementById('processingSpeed').textContent = '-';
                document.getElementById('responseTime').textContent = '-';
                
                showAlert('success', 'æ¼”ç¤ºçŠ¶æ€å·²é‡ç½®');
            } catch (error) {
                showAlert('error', 'é‡ç½®å¤±è´¥: ' + error.message);
            }
        }
        
        // æ˜¾ç¤ºç®—æ³•å¯¹æ¯”
        async function showComparison() {
            try {
                const response = await fetch(`${demoAPI}/api/algorithm/comparison`);
                const data = await response.json();
                
                const section = document.getElementById('comparisonSection');
                const grid = document.getElementById('comparisonGrid');
                
                let html = '';
                Object.keys(data.comparison_data).forEach(key => {
                    const algo = data.comparison_data[key];
                    const isOurs = key === 'our_algorithm';
                    
                    html += `
                        <div class="algorithm-card ${isOurs ? 'our-algorithm' : ''}">
                            <div class="algorithm-name">${algo.name}</div>
                            <div class="performance-grid">
                                <div class="performance-item">
                                    <div class="performance-label">å‡†ç¡®ç‡</div>
                                    <div class="performance-value">${algo.accuracy}%</div>
                                </div>
                                <div class="performance-item">
                                    <div class="performance-label">ç²¾ç¡®ç‡</div>
                                    <div class="performance-value">${algo.precision}%</div>
                                </div>
                                <div class="performance-item">
                                    <div class="performance-label">å¬å›ç‡</div>
                                    <div class="performance-value">${algo.recall}%</div>
                                </div>
                                <div class="performance-item">
                                    <div class="performance-label">å¤„ç†é€Ÿåº¦</div>
                                    <div class="performance-value">${algo.processing_speed}</div>
                                </div>
                                <div class="performance-item">
                                    <div class="performance-label">è¯¯æŠ¥ç‡</div>
                                    <div class="performance-value">${(algo.false_positive_rate * 100).toFixed(2)}%</div>
                                </div>
                                <div class="performance-item">
                                    <div class="performance-label">å»¶è¿Ÿ</div>
                                    <div class="performance-value">${algo.detection_latency}</div>
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                ${algo.features.map(f => `<div style="font-size: 0.9em; margin: 5px 0;">â€¢ ${f}</div>`).join('')}
                            </div>
                        </div>
                    `;
                });
                
                grid.innerHTML = html;
                section.style.display = 'block';
                section.scrollIntoView({behavior: 'smooth'});
                
            } catch (error) {
                showAlert('error', 'åŠ è½½å¯¹æ¯”æ•°æ®å¤±è´¥: ' + error.message);
            }
        }
        
        // åŠ è½½ç®—æ³•äº®ç‚¹
        async function loadAlgorithmHighlights() {
            try {
                const response = await fetch(`${demoAPI}/api/demo/highlights`);
                const data = await response.json();
                
                const grid = document.getElementById('highlightsGrid');
                const highlights = data.algorithm_highlights;
                
                grid.innerHTML = `
                    <div class="info-item">
                        <div class="info-label">ç²¾åº¦æå‡</div>
                        <div class="info-value">${highlights.accuracy_improvement}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">è¯¯æŠ¥é™ä½</div>
                        <div class="info-value">${highlights.false_positive_reduction}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">é€Ÿåº¦æå‡</div>
                        <div class="info-value">${highlights.speed_improvement}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">è€å¹´äººä¼˜åŒ–</div>
                        <div class="info-value">${highlights.elderly_optimized ? 'âœ… æ˜¯' : 'âŒ å¦'}</div>
                    </div>
                `;
            } catch (error) {
                console.error('åŠ è½½ç®—æ³•äº®ç‚¹å¤±è´¥:', error);
            }
        }
        
        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        function showAlert(type, message) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            
            document.getElementById('detectionResults').appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }
        
        // è·å–äº‹ä»¶ç±»å‹æ–‡æœ¬
        function getEventTypeText(subtype) {
            const types = {
                'backward_fall': 'å‘åè·Œå€’',
                'forward_fall': 'å‘å‰è·Œå€’', 
                'side_fall': 'ä¾§å‘è·Œå€’',
                'fall_detected': 'è·Œå€’æ£€æµ‹'
            };
            return types[subtype] || subtype;
        }
        
        // è·å–æ–¹å‘æ–‡æœ¬
        function getDirectionText(direction) {
            const directions = {
                'backward': 'å‘å',
                'forward': 'å‘å‰',
                'side': 'ä¾§å‘',
                'left': 'å·¦ä¾§',
                'right': 'å³ä¾§'
            };
            return directions[direction] || direction;
        }
        
        // å®šæœŸæ›´æ–°APIçŠ¶æ€
        setInterval(checkAPIStatus, 30000);
    </script>
</body>
</html>