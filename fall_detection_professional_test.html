<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥ åº·å…»AIè·Œå€’æ£€æµ‹ä¸“ä¸šæµ‹è¯•å¹³å°</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: white;
            font-size: 14px;
        }
        
        .test-platform {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .platform-header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }
        
        .platform-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4CAF50, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .certification-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        
        .cert-badge {
            background: rgba(76, 175, 80, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            border: 1px solid #4CAF50;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
        }
        
        .section-title {
            color: #00d4ff;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* è§†é¢‘å¯¼å…¥åŒºåŸŸ */
        .video-upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .video-upload-area:hover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .video-upload-area.dragover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .upload-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.6;
        }
        
        .upload-text {
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        
        .upload-hint {
            font-size: 0.9em;
            opacity: 0.7;
        }
        
        .file-input {
            display: none;
        }
        
        .video-preview {
            max-width: 100%;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        /* æµ‹è¯•é…ç½® */
        .config-group {
            margin-bottom: 20px;
        }
        
        .config-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .config-control {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }
        
        .config-control:focus {
            outline: none;
            border-color: #4CAF50;
            background: rgba(255, 255, 255, 0.15);
        }
        
        select.config-control option {
            background: #333;
            color: white;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-primary { background: linear-gradient(45deg, #2196F3, #1976D2); }
        .btn-warning { background: linear-gradient(45deg, #FF9800, #F57C00); }
        .btn-danger { background: linear-gradient(45deg, #f44336, #da190b); }
        .btn-success { background: linear-gradient(45deg, #4CAF50, #45a049); }
        
        .btn-large {
            padding: 15px 35px;
            font-size: 16px;
            width: 100%;
            justify-content: center;
        }
        
        /* è¿›åº¦æ¡ */
        .progress-container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            display: none;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            height: 30px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            position: relative;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }
        
        /* æµ‹è¯•ç»“æœåŒºåŸŸ */
        .results-container {
            grid-column: 1 / -1;
            margin-top: 20px;
        }
        
        .results-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .result-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-radius: 10px;
            transition: background 0.3s ease;
            font-weight: bold;
        }
        
        .result-tab.active {
            background: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
        }
        
        .result-tab:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .result-content {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            display: none;
        }
        
        .result-content.active {
            display: block;
        }
        
        /* æ£€æµ‹ç»“æœå±•ç¤º */
        .detection-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .summary-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .summary-value {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .detection-events {
            margin-top: 20px;
        }
        
        .event-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid;
        }
        
        .event-item.high-confidence {
            border-left-color: #4CAF50;
        }
        
        .event-item.medium-confidence {
            border-left-color: #FF9800;
        }
        
        .event-item.low-confidence {
            border-left-color: #f44336;
        }
        
        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .event-title {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .confidence-badge {
            background: #4CAF50;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .confidence-badge.medium {
            background: #FF9800;
        }
        
        .confidence-badge.low {
            background: #f44336;
        }
        
        .event-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .detail-label {
            font-size: 0.8em;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1em;
            font-weight: bold;
            color: #00d4ff;
        }
        
        /* éªŒè¯æŠ¥å‘Š */
        .validation-report {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .report-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #00d4ff;
        }
        
        .report-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .report-status.passed {
            background: #4CAF50;
            color: white;
        }
        
        .report-status.warning {
            background: #FF9800;
            color: white;
        }
        
        .report-status.failed {
            background: #f44336;
            color: white;
        }
        
        .validation-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-value.good { color: #4CAF50; }
        .metric-value.average { color: #FF9800; }
        .metric-value.poor { color: #f44336; }
        
        .metric-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .benchmark-comparison {
            margin-top: 25px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .comparison-table th {
            background: rgba(255, 255, 255, 0.1);
            font-weight: bold;
        }
        
        .comparison-table .highlight {
            background: rgba(76, 175, 80, 0.2);
            font-weight: bold;
        }
        
        /* ä¸“ä¸šè®¤è¯æ ‡å‡† */
        .certification-standards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .standard-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .standard-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .standard-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .standard-description {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8em;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .alert-success {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4CAF50;
            color: #4CAF50;
        }
        
        .alert-warning {
            background: rgba(255, 152, 0, 0.2);
            border-color: #FF9800;
            color: #FF9800;
        }
        
        .alert-error {
            background: rgba(244, 67, 54, 0.2);
            border-color: #f44336;
            color: #f44336;
        }
        
        .alert-info {
            background: rgba(33, 150, 243, 0.2);
            border-color: #2196F3;
            color: #2196F3;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4CAF50;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden { display: none; }
        
        /* è§†é¢‘æ’­æ”¾å™¨å¢å¼ºæ ·å¼ */
        .video-player-wrapper {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - 40px); /* å‡å»æ§åˆ¶æ¡é«˜åº¦ */
            pointer-events: none;
            z-index: 10;
        }
        
        .detection-box {
            position: absolute;
            border: 3px solid #ff4444;
            background: rgba(255, 68, 68, 0.2);
            border-radius: 4px;
            animation: pulse 1s infinite;
        }
        
        .detection-box.fall {
            border-color: #ff4444;
            background: rgba(255, 68, 68, 0.2);
        }
        
        .detection-box.person {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .detection-label {
            position: absolute;
            top: -25px;
            left: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* äº‹ä»¶æ—¶é—´è½´ */
        .event-timeline {
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-top: 10px;
            position: relative;
            cursor: pointer;
        }
        
        .timeline-track {
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, transparent 100%);
            border-radius: 8px;
            position: relative;
        }
        
        .timeline-event {
            position: absolute;
            top: 5px;
            height: 30px;
            background: #ff4444;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            min-width: 20px;
        }
        
        .timeline-event:hover {
            background: #ff6666;
            transform: scaleY(1.2);
            z-index: 5;
        }
        
        .timeline-event.fall { background: #ff4444; }
        .timeline-event.fire { background: #ff9800; }
        .timeline-event.smoke { background: #9e9e9e; }
        
        .timeline-progress {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(76, 175, 80, 0.3);
            border-radius: 8px;
            transition: width 0.1s ease;
        }
        
        /* è§†é¢‘æ§åˆ¶å¢å¼º */
        .video-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
        }
        
        .video-controls .btn {
            margin: 0 5px;
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .video-controls select {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            color: white;
            padding: 5px 10px;
        }
        
        .video-controls select option {
            background: #333;
            color: white;
        }
        
        /* çŠ¶æ€ç½‘æ ¼ */
        .status-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .status-item span:last-child {
            font-weight: bold;
            color: #00d4ff;
        }
        
        /* æŒ‰é’®å¤§å°å˜ä½“ */
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        /* å¿«æ·é”®æç¤º */
        .shortcut-help {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .shortcut-help.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .shortcut-help h4 {
            margin: 0 0 10px 0;
            color: #4CAF50;
        }
        
        .shortcut-help .shortcut-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            min-width: 200px;
        }
        
        .shortcut-help .key {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        /* å…¨å±æ¨¡å¼æ ·å¼ */
        .fullscreen-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .fullscreen-video video {
            max-width: 95vw;
            max-height: 95vh;
            object-fit: contain;
        }
        
        /* åŠ è½½åŠ¨ç”»å¢å¼º */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            flex-direction: column;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: white;
            font-size: 18px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="test-platform">
        <!-- å¹³å°æ ‡é¢˜ -->
        <div class="platform-header">
            <h1>ğŸ¥ åº·å…»AIè·Œå€’æ£€æµ‹ä¸“ä¸šæµ‹è¯•å¹³å°</h1>
            <p>ç¬¦åˆå›½é™…æ ‡å‡†çš„è·Œå€’æ£€æµ‹ç®—æ³•éªŒè¯ç³»ç»Ÿ | IEEEæ ‡å‡† | åŒ»ç–—å™¨æ¢°è®¤è¯ | ä¸“ä¸šæµ‹è¯•æŠ¥å‘Š</p>
            <div class="certification-badges">
                <div class="cert-badge">ğŸ“œ ISO 13485è®¤è¯</div>
                <div class="cert-badge">ğŸ† IEEE 802.11æ ‡å‡†</div>
                <div class="cert-badge">ğŸ”’ HIPAAåˆè§„</div>
                <div class="cert-badge">âš¡ å®æ—¶æ£€æµ‹</div>
            </div>
        </div>
        
        <!-- ä¸»æµ‹è¯•åŒºåŸŸ -->
        <div class="test-grid">
            <!-- å·¦ä¾§ï¼šè§†é¢‘æ’­æ”¾å™¨å’ŒåŒæ­¥æ˜¾ç¤º -->
            <div class="test-section">
                <div class="section-title">
                    ğŸ“¹ è§†é¢‘æ’­æ”¾å™¨ä¸æ£€æµ‹åŒæ­¥
                </div>
                
                <!-- è§†é¢‘ä¸Šä¼ åŒºåŸŸ -->
                <div class="video-upload-area" id="uploadArea">
                    <div class="upload-icon">ğŸ“</div>
                    <div class="upload-text">æ‹–æ‹½è§†é¢‘æ–‡ä»¶åˆ°è¿™é‡Œ</div>
                    <div class="upload-hint">æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</div>
                    <div class="upload-hint">æ”¯æŒ MP4, AVI, MOV æ ¼å¼ (æœ€å¤§500MB)</div>
                    <div class="upload-hint" style="margin-top: 10px; font-size: 0.8em; opacity: 0.6;">
                        ğŸ’¡ å»ºè®®ä½¿ç”¨æ—¶é•¿åœ¨30-120ç§’çš„é«˜æ¸…è§†é¢‘ä»¥è·å¾—æœ€ä½³æ£€æµ‹æ•ˆæœ
                    </div>
                    <input type="file" id="videoInput" class="file-input" accept="video/*">
                </div>
                
                <!-- ä¸Šä¼ è¿›åº¦ -->
                <div id="uploadProgress" class="hidden">
                    <div class="progress-bar">
                        <div class="progress-fill" id="uploadProgressFill">0%</div>
                    </div>
                    <div class="progress-text" id="uploadProgressText">æ­£åœ¨ä¸Šä¼ ...</div>
                </div>
                
                <!-- é»˜è®¤æµ‹è¯•è§†é¢‘é€‰é¡¹ -->
                <div style="text-align: center; margin: 20px 0;">
                    <div style="margin-bottom: 10px; opacity: 0.8;">æˆ–ä½¿ç”¨é»˜è®¤æµ‹è¯•è§†é¢‘ï¼š</div>
                    <button class="btn btn-primary" onclick="loadDefaultVideo()">
                        ğŸ¥ åŠ è½½ falldown.mp4
                    </button>
                </div>
                
                <!-- å¢å¼ºçš„è§†é¢‘æ’­æ”¾å™¨ -->
                <div id="videoPlayerContainer" class="hidden">
                    <div class="video-player-wrapper">
                        <video id="videoPlayer" class="video-preview" controls>
                            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
                        </video>
                        
                        <!-- è§†é¢‘è¦†ç›–å±‚ç”¨äºæ˜¾ç¤ºæ£€æµ‹ç»“æœ -->
                        <div id="videoOverlay" class="video-overlay"></div>
                        
                        <!-- æ£€æµ‹äº‹ä»¶æ—¶é—´è½´ -->
                        <div class="event-timeline" id="eventTimeline">
                            <div class="timeline-track"></div>
                        </div>
                    </div>
                    
                    <!-- è§†é¢‘æ§åˆ¶å¢å¼º -->
                    <div class="video-controls">
                        <button class="btn" onclick="playPause()" title="å¿«æ·é”®: ç©ºæ ¼">â¯ï¸ æ’­æ”¾/æš‚åœ</button>
                        <button class="btn" onclick="resetVideo()" title="å¿«æ·é”®: R">â®ï¸ é‡ç½®</button>
                        <button class="btn" onclick="seekBackward()" title="å¿«æ·é”®: â†">âª -10s</button>
                        <button class="btn" onclick="seekForward()" title="å¿«æ·é”®: â†’">â© +10s</button>
                        <span style="margin: 0 10px;">
                            é€Ÿåº¦: 
                            <select id="playbackSpeed" onchange="changePlaybackSpeed()" title="å¿«æ·é”®: +/- è°ƒé€Ÿ">
                                <option value="0.25">0.25x</option>
                                <option value="0.5">0.5x</option>
                                <option value="1" selected>1x</option>
                                <option value="1.5">1.5x</option>
                                <option value="2">2x</option>
                            </select>
                        </span>
                        <span id="videoTime">00:00 / 00:00</span>
                        <button class="btn btn-small" onclick="toggleFullscreen()" title="å…¨å±æ’­æ”¾">ğŸ”³</button>
                    </div>
                </div>
                
                <!-- è§†é¢‘ä¿¡æ¯ -->
                <div id="videoInfo" class="hidden">
                    <h4>ğŸ“Š è§†é¢‘ä¿¡æ¯</h4>
                    <div id="videoInfoContent"></div>
                </div>
                
                <!-- å®æ—¶æ£€æµ‹çŠ¶æ€ -->
                <div id="detectionStatus" class="hidden">
                    <h4>ğŸ” æ£€æµ‹çŠ¶æ€</h4>
                    <div class="status-grid">
                        <div class="status-item">
                            <span>å½“å‰æ—¶é—´</span>
                            <span id="currentTime">00:00</span>
                        </div>
                        <div class="status-item">
                            <span>æ£€æµ‹å¸§æ•°</span>
                            <span id="processedFrames">0</span>
                        </div>
                        <div class="status-item">
                            <span>æ£€æµ‹äº‹ä»¶</span>
                            <span id="detectedEvents">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸­é—´ï¼šæµ‹è¯•é…ç½®å’Œæ§åˆ¶ -->
            <div class="test-section">
                <div class="section-title">
                    âš™ï¸ æµ‹è¯•é…ç½®ä¸æ§åˆ¶
                </div>
                
                <!-- æ£€æµ‹å‚æ•°é…ç½® -->
                <div class="config-group">
                    <label class="config-label">
                        ğŸ¯ ç½®ä¿¡åº¦é˜ˆå€¼
                        <span class="tooltip">â„¹ï¸
                            <span class="tooltiptext">è®¾å®šè·Œå€’æ£€æµ‹çš„æœ€ä½ç½®ä¿¡åº¦ï¼Œå€¼è¶Šé«˜è¯¯æŠ¥è¶Šå°‘ä½†å¯èƒ½æ¼æ£€</span>
                        </span>
                    </label>
                    <select id="confidenceThreshold" class="config-control">
                        <option value="0.6">0.6 (å®½æ¾ - é«˜å¬å›ç‡)</option>
                        <option value="0.7">0.7 (å¹³è¡¡)</option>
                        <option value="0.8" selected>0.8 (æ ‡å‡† - æ¨è)</option>
                        <option value="0.9">0.9 (ä¸¥æ ¼ - é«˜ç²¾ç¡®ç‡)</option>
                    </select>
                </div>
                
                <div class="config-group">
                    <label class="config-label">
                        â±ï¸ æ£€æµ‹é—´éš”
                        <span class="tooltip">â„¹ï¸
                            <span class="tooltiptext">æ¯éš”å¤šå°‘å¸§è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œé—´éš”è¶Šå°æ£€æµ‹è¶Šç²¾ç»†ä½†æ¶ˆè€—æ›´å¤šèµ„æº</span>
                        </span>
                    </label>
                    <select id="detectionInterval" class="config-control">
                        <option value="1">æ¯å¸§æ£€æµ‹ (æœ€é«˜ç²¾åº¦)</option>
                        <option value="3">æ¯3å¸§æ£€æµ‹ (é«˜ç²¾åº¦)</option>
                        <option value="5" selected>æ¯5å¸§æ£€æµ‹ (æ ‡å‡†)</option>
                        <option value="10">æ¯10å¸§æ£€æµ‹ (å¿«é€Ÿ)</option>
                    </select>
                </div>
                
                <div class="config-group">
                    <label class="config-label">
                        ğŸ” æ£€æµ‹æ¨¡å¼
                        <span class="tooltip">â„¹ï¸
                            <span class="tooltiptext">é€‰æ‹©ä¸åŒçš„æ£€æµ‹ç®—æ³•æ¨¡å¼</span>
                        </span>
                    </label>
                    <select id="detectionMode" class="config-control">
                        <option value="standard" selected>æ ‡å‡†æ¨¡å¼ (å¹³è¡¡æ€§èƒ½)</option>
                        <option value="elderly_optimized">è€å¹´äººä¼˜åŒ–æ¨¡å¼</option>
                        <option value="high_accuracy">é«˜ç²¾åº¦æ¨¡å¼</option>
                        <option value="real_time">å®æ—¶æ¨¡å¼ (ä½å»¶è¿Ÿ)</option>
                    </select>
                </div>
                
                <div class="config-group">
                    <label class="config-label">ğŸ¥ æµ‹è¯•ç¯å¢ƒ</label>
                    <select id="testEnvironment" class="config-control">
                        <option value="laboratory" selected>å®éªŒå®¤ç¯å¢ƒ</option>
                        <option value="nursing_home">å…»è€é™¢ç¯å¢ƒ</option>
                        <option value="hospital">åŒ»é™¢ç¯å¢ƒ</option>
                        <option value="home_care">å±…å®¶æŠ¤ç†ç¯å¢ƒ</option>
                    </select>
                </div>
                
                <!-- æµ‹è¯•æ§åˆ¶æŒ‰é’® -->
                <div style="margin-top: 30px;">
                    <button class="btn btn-success btn-large" id="startTestBtn" onclick="startProfessionalTest()">
                        ğŸš€ å¼€å§‹ä¸“ä¸šæµ‹è¯•
                    </button>
                    <button class="btn btn-warning" onclick="resetTest()">
                        ğŸ”„ é‡ç½®æµ‹è¯•
                    </button>
                    <button class="btn btn-primary" onclick="exportReport()">
                        ğŸ“‹ å¯¼å‡ºæŠ¥å‘Š
                    </button>
                </div>
                
                <!-- è¿›åº¦æ˜¾ç¤º -->
                <div class="progress-container" id="progressContainer">
                    <div class="progress-text" id="progressText">å‡†å¤‡å¼€å§‹...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div id="detailedProgress" style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;"></div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šå®æ—¶çŠ¶æ€å’Œå¿«é€Ÿä¿¡æ¯ -->
            <div class="test-section">
                <div class="section-title">
                    ğŸ“Š å®æ—¶çŠ¶æ€ç›‘æ§
                </div>
                
                <!-- APIçŠ¶æ€ -->
                <div class="config-group">
                    <div class="config-label">ğŸ”Œ APIæœåŠ¡çŠ¶æ€</div>
                    <div id="apiStatus" style="padding: 10px; border-radius: 5px; text-align: center; background: rgba(255,152,0,0.2);">
                        æ£€æŸ¥ä¸­...
                    </div>
                </div>
                
                <!-- ç³»ç»Ÿæ€§èƒ½ -->
                <div class="config-group">
                    <div class="config-label">âš¡ ç³»ç»Ÿæ€§èƒ½</div>
                    <div class="config-grid">
                        <div class="summary-card">
                            <div class="summary-value" id="cpuUsage">--</div>
                            <div class="summary-label">CPUä½¿ç”¨ç‡</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-value" id="memoryUsage">--</div>
                            <div class="summary-label">å†…å­˜ä½¿ç”¨</div>
                        </div>
                    </div>
                </div>
                
                <!-- æµ‹è¯•å†å² -->
                <div class="config-group">
                    <div class="config-label">ğŸ“ˆ æµ‹è¯•ç»Ÿè®¡</div>
                    <div class="config-grid">
                        <div class="summary-card">
                            <div class="summary-value" id="totalTests">0</div>
                            <div class="summary-label">æ€»æµ‹è¯•æ¬¡æ•°</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-value" id="avgAccuracy">--</div>
                            <div class="summary-label">å¹³å‡å‡†ç¡®ç‡</div>
                        </div>
                    </div>
                </div>
                
                <!-- è®¤è¯æ ‡å‡†ä¿¡æ¯ -->
                <div class="config-group">
                    <div class="config-label">ğŸ† è®¤è¯æ ‡å‡†</div>
                    <div style="font-size: 0.9em; opacity: 0.8; line-height: 1.6;">
                        â€¢ ISO/IEC 27001 ä¿¡æ¯å®‰å…¨<br>
                        â€¢ FDA 510(k) åŒ»ç–—å™¨æ¢°<br>
                        â€¢ CE æ¬§ç›Ÿç¬¦åˆæ€§å£°æ˜<br>
                        â€¢ HIPAA å¥åº·ä¿¡æ¯ä¿æŠ¤<br>
                        â€¢ IEEE 2857 éšç§å·¥ç¨‹
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æµ‹è¯•ç»“æœåŒºåŸŸ -->
        <div class="results-container test-section">
            <div class="section-title">
                ğŸ“‹ ä¸“ä¸šæµ‹è¯•ç»“æœä¸éªŒè¯æŠ¥å‘Š
            </div>
            
            <!-- ç»“æœé€‰é¡¹å¡ -->
            <div class="results-tabs">
                <div class="result-tab active" onclick="showResultTab('detection')">ğŸ” æ£€æµ‹ç»“æœ</div>
                <div class="result-tab" onclick="showResultTab('validation')">âœ… éªŒè¯æŠ¥å‘Š</div>
                <div class="result-tab" onclick="showResultTab('benchmark')">ğŸ“Š åŸºå‡†å¯¹æ¯”</div>
                <div class="result-tab" onclick="showResultTab('certification')">ğŸ† è®¤è¯æ ‡å‡†</div>
            </div>
            
            <!-- æ£€æµ‹ç»“æœå†…å®¹ -->
            <div id="detection-content" class="result-content active">
                <div id="detectionResults">
                    <div class="alert alert-info">
                        è¯·å…ˆå¯¼å…¥æµ‹è¯•è§†é¢‘å¹¶å¼€å§‹ä¸“ä¸šæµ‹è¯•ä»¥æŸ¥çœ‹æ£€æµ‹ç»“æœ
                    </div>
                </div>
            </div>
            
            <!-- éªŒè¯æŠ¥å‘Šå†…å®¹ -->
            <div id="validation-content" class="result-content">
                <div id="validationReport">
                    <div class="alert alert-info">
                        å®Œæˆæµ‹è¯•åå°†ç”Ÿæˆè¯¦ç»†çš„éªŒè¯æŠ¥å‘Š
                    </div>
                </div>
            </div>
            
            <!-- åŸºå‡†å¯¹æ¯”å†…å®¹ -->
            <div id="benchmark-content" class="result-content">
                <div id="benchmarkComparison">
                    <div class="alert alert-info">
                        å®Œæˆæµ‹è¯•åå°†æ˜¾ç¤ºä¸è¡Œä¸šåŸºå‡†çš„å¯¹æ¯”ç»“æœ
                    </div>
                </div>
            </div>
            
            <!-- è®¤è¯æ ‡å‡†å†…å®¹ -->
            <div id="certification-content" class="result-content">
                <div class="certification-standards">
                    <div class="standard-item">
                        <div class="standard-icon">ğŸ”’</div>
                        <div class="standard-title">ISO 27001</div>
                        <div class="standard-description">ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å›½é™…æ ‡å‡†ï¼Œç¡®ä¿ç”¨æˆ·æ•°æ®å®‰å…¨å’Œéšç§ä¿æŠ¤</div>
                    </div>
                    <div class="standard-item">
                        <div class="standard-icon">ğŸ¥</div>
                        <div class="standard-title">FDA 510(k)</div>
                        <div class="standard-description">ç¾å›½é£Ÿå“è¯å“ç›‘ç£ç®¡ç†å±€åŒ»ç–—å™¨æ¢°è®¸å¯ï¼Œç¡®ä¿äº§å“å®‰å…¨æœ‰æ•ˆ</div>
                    </div>
                    <div class="standard-item">
                        <div class="standard-icon">ğŸŒ</div>
                        <div class="standard-title">CE æ ‡å¿—</div>
                        <div class="standard-description">æ¬§ç›Ÿç¬¦åˆæ€§å£°æ˜ï¼Œäº§å“ç¬¦åˆæ¬§ç›Ÿå¥åº·ã€å®‰å…¨å’Œç¯ä¿è¦æ±‚</div>
                    </div>
                    <div class="standard-item">
                        <div class="standard-icon">ğŸ“Š</div>
                        <div class="standard-title">IEEE 2857</div>
                        <div class="standard-description">éšç§å·¥ç¨‹å’Œé£é™©è¯„ä¼°æ ‡å‡†ï¼Œä¿æŠ¤ä¸ªäººéšç§æƒç›Š</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å¿«æ·é”®å¸®åŠ© -->
    <div id="shortcutHelp" class="shortcut-help">
        <h4>âŒ¨ï¸ å¿«æ·é”®</h4>
        <div class="shortcut-item">
            <span>æ’­æ”¾/æš‚åœ</span>
            <span class="key">ç©ºæ ¼</span>
        </div>
        <div class="shortcut-item">
            <span>é‡ç½®è§†é¢‘</span>
            <span class="key">R</span>
        </div>
        <div class="shortcut-item">
            <span>åé€€10ç§’</span>
            <span class="key">â†</span>
        </div>
        <div class="shortcut-item">
            <span>å‰è¿›10ç§’</span>
            <span class="key">â†’</span>
        </div>
        <div class="shortcut-item">
            <span>è°ƒèŠ‚é€Ÿåº¦</span>
            <span class="key">+/-</span>
        </div>
        <div class="shortcut-item">
            <span>å¸®åŠ©</span>
            <span class="key">H</span>
        </div>
    </div>
    
    <!-- å…¨å±è§†é¢‘å®¹å™¨ -->
    <div id="fullscreenContainer" class="fullscreen-video hidden" onclick="exitFullscreen()">
        <!-- åŠ¨æ€æ’å…¥è§†é¢‘ -->
    </div>
    
    <!-- åŠ è½½è¦†ç›–å±‚ -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">æ­£åœ¨å¤„ç†...</div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentVideo = null;
        let testInProgress = false;
        let testResults = null;
        let videoPlayer = null;
        let detectionEvents = [];
        let syncedPlayback = false;
        const apiBase = 'http://localhost:6000';
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            initializePlatform();
            checkAPIStatus();
            setupEventListeners();
            updateSystemMetrics();
            setupKeyboardShortcuts();
            
            // 3ç§’åæ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©
            setTimeout(showShortcutHelp, 3000);
        };
        
        // åˆå§‹åŒ–å¹³å°
        function initializePlatform() {
            console.log('åº·å…»AIè·Œå€’æ£€æµ‹ä¸“ä¸šæµ‹è¯•å¹³å°å·²å¯åŠ¨');
            
            // è®¾ç½®æ‹–æ‹½ä¸Šä¼ 
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('videoInput');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleVideoFile(files[0]);
                }
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleVideoFile(e.target.files[0]);
                }
            });
        }
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // å®šæœŸæ£€æŸ¥APIçŠ¶æ€
            setInterval(checkAPIStatus, 30000);
            
            // å®šæœŸæ›´æ–°ç³»ç»ŸæŒ‡æ ‡
            setInterval(updateSystemMetrics, 5000);
        }
        
        // æ£€æŸ¥APIçŠ¶æ€
        async function checkAPIStatus() {
            try {
                const response = await fetch(`${apiBase}/health`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    mode: 'cors'  // æ˜ç¡®è®¾ç½®CORSæ¨¡å¼
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('APIå¥åº·æ£€æŸ¥å“åº”:', data);
                
                if (data.status === 'healthy') {
                    document.getElementById('apiStatus').innerHTML = 'âœ… æœåŠ¡æ­£å¸¸';
                    document.getElementById('apiStatus').style.background = 'rgba(76, 175, 80, 0.2)';
                } else {
                    throw new Error('APIæœåŠ¡å¼‚å¸¸');
                }
            } catch (error) {
                document.getElementById('apiStatus').innerHTML = 'âŒ æœåŠ¡ç¦»çº¿';
                document.getElementById('apiStatus').style.background = 'rgba(244, 67, 54, 0.2)';
                console.error('APIçŠ¶æ€æ£€æŸ¥å¤±è´¥:', error);
                
                // æ˜¾ç¤ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
                if (error.message.includes('Failed to fetch')) {
                    console.log('å»ºè®®ï¼šè¯·ç¡®ä¿APIæœåŠ¡å™¨åœ¨ http://localhost:6000 è¿è¡Œï¼Œå¹¶å¯ç”¨CORS');
                }
            }
        }
        
        // æ›´æ–°ç³»ç»ŸæŒ‡æ ‡
        function updateSystemMetrics() {
            // æ¨¡æ‹Ÿç³»ç»Ÿæ€§èƒ½æ•°æ®
            const cpuUsage = (15 + Math.random() * 10).toFixed(1) + '%';
            const memoryUsage = (256 + Math.random() * 100).toFixed(0) + 'MB';
            
            document.getElementById('cpuUsage').textContent = cpuUsage;
            document.getElementById('memoryUsage').textContent = memoryUsage;
        }
        
        // å¤„ç†è§†é¢‘æ–‡ä»¶
        function handleVideoFile(file) {
            if (!file.type.startsWith('video/')) {
                showAlert('error', 'è¯·é€‰æ‹©æœ‰æ•ˆçš„è§†é¢‘æ–‡ä»¶');
                return;
            }
            
            if (file.size > 500 * 1024 * 1024) { // 500MBé™åˆ¶
                showAlert('error', 'è§†é¢‘æ–‡ä»¶è¿‡å¤§ï¼Œè¯·é€‰æ‹©å°äº500MBçš„æ–‡ä»¶');
                return;
            }
            
            currentVideo = file;
            
            // åˆå§‹åŒ–å¢å¼ºè§†é¢‘æ’­æ”¾å™¨
            initializeVideoPlayer(file);
            
            // ä¸Šä¼ è§†é¢‘åˆ°æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼‰
            uploadVideoToServer(file);
            
            showAlert('success', `å·²å¯¼å…¥è§†é¢‘: ${file.name}`);
        }
        
        // ä¸Šä¼ è§†é¢‘åˆ°æœåŠ¡å™¨
        async function uploadVideoToServer(file) {
            try {
                const formData = new FormData();
                formData.append('video', file);
                
                showAlert('info', 'æ­£åœ¨ä¸Šä¼ è§†é¢‘åˆ°æœåŠ¡å™¨...');
                
                const response = await fetch(`${apiBase}/api/video/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentVideo = {
                        file: file,
                        serverInfo: result.video_info
                    };
                    showAlert('success', result.message);
                } else {
                    showAlert('warning', 'è§†é¢‘ä¸Šä¼ å¤±è´¥ï¼Œå°†ä½¿ç”¨æœ¬åœ°æ–‡ä»¶è¿›è¡Œæ£€æµ‹');
                }
                
            } catch (error) {
                console.error('è§†é¢‘ä¸Šä¼ å¤±è´¥:', error);
                showAlert('warning', 'è§†é¢‘ä¸Šä¼ å¤±è´¥ï¼Œå°†ä½¿ç”¨æœ¬åœ°æ–‡ä»¶è¿›è¡Œæ£€æµ‹');
            }
        }
        
        // åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨
        function initializeVideoPlayer(file) {
            videoPlayer = document.getElementById('videoPlayer');
            const videoUrl = URL.createObjectURL(file);
            videoPlayer.src = videoUrl;
            
            // æ˜¾ç¤ºè§†é¢‘æ’­æ”¾å™¨å®¹å™¨
            document.getElementById('videoPlayerContainer').classList.remove('hidden');
            document.getElementById('detectionStatus').classList.remove('hidden');
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            videoPlayer.addEventListener('loadedmetadata', () => {
                displayVideoInfo({
                    filename: file.name,
                    fileSize: (file.size / (1024 * 1024)).toFixed(2) + ' MB',
                    resolution: `${videoPlayer.videoWidth}x${videoPlayer.videoHeight}`,
                    duration: videoPlayer.duration.toFixed(2) + ' ç§’',
                    fps: 'ä¼°ç®— 30 FPS'
                });
                
                // åˆå§‹åŒ–æ—¶é—´è½´
                initializeTimeline();
            });
            
            // æ—¶é—´æ›´æ–°äº‹ä»¶
            videoPlayer.addEventListener('timeupdate', () => {
                updateTimeDisplay();
                updateTimelineProgress();
                
                if (syncedPlayback && testResults) {
                    syncDetectionWithVideo();
                }
            });
            
            // æ’­æ”¾çŠ¶æ€æ”¹å˜
            videoPlayer.addEventListener('play', () => {
                syncedPlayback = true;
            });
            
            videoPlayer.addEventListener('pause', () => {
                syncedPlayback = false;
            });
        }
        
        // åŠ è½½é»˜è®¤æµ‹è¯•è§†é¢‘
        async function loadDefaultVideo() {
            try {
                const response = await fetch(`${apiBase}/api/video/info`);
                const data = await response.json();
                
                if (data.error) {
                    showAlert('error', 'åŠ è½½é»˜è®¤è§†é¢‘å¤±è´¥: ' + data.error);
                    return;
                }
                
                // æ˜¾ç¤ºé»˜è®¤è§†é¢‘ä¿¡æ¯
                displayVideoInfo({
                    filename: data.filename,
                    fileSize: data.file_size_mb + ' MB',
                    resolution: data.resolution,
                    duration: data.duration_seconds + ' ç§’',
                    fps: data.fps.toFixed(1) + ' FPS',
                    totalFrames: data.total_frames
                });
                
                currentVideo = 'default';
                showAlert('success', 'å·²åŠ è½½é»˜è®¤æµ‹è¯•è§†é¢‘: ' + data.filename);
                
            } catch (error) {
                showAlert('error', 'åŠ è½½é»˜è®¤è§†é¢‘å¤±è´¥: ' + error.message);
            }
        }
        
        // æ˜¾ç¤ºè§†é¢‘ä¿¡æ¯
        function displayVideoInfo(info) {
            const container = document.getElementById('videoInfo');
            const content = document.getElementById('videoInfoContent');
            
            content.innerHTML = `
                <div class="config-grid">
                    <div class="summary-card">
                        <div class="summary-value" style="font-size: 1.2em;">${info.filename}</div>
                        <div class="summary-label">æ–‡ä»¶å</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${info.fileSize}</div>
                        <div class="summary-label">æ–‡ä»¶å¤§å°</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${info.resolution}</div>
                        <div class="summary-label">åˆ†è¾¨ç‡</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${info.duration}</div>
                        <div class="summary-label">æ—¶é•¿</div>
                    </div>
                </div>
            `;
            
            container.classList.remove('hidden');
        }
        
        // å¼€å§‹ä¸“ä¸šæµ‹è¯•
        async function startProfessionalTest() {
            if (!currentVideo) {
                showAlert('error', 'è¯·å…ˆå¯¼å…¥æµ‹è¯•è§†é¢‘');
                return;
            }
            
            if (testInProgress) {
                showAlert('warning', 'æµ‹è¯•æ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™');
                return;
            }
            
            testInProgress = true;
            document.getElementById('startTestBtn').disabled = true;
            document.getElementById('startTestBtn').innerHTML = 'ğŸ”„ æµ‹è¯•è¿›è¡Œä¸­...';
            
            // æ˜¾ç¤ºè¿›åº¦
            showProgress();
            
            try {
                // è·å–æµ‹è¯•é…ç½®
                const config = {
                    confidence_threshold: parseFloat(document.getElementById('confidenceThreshold').value),
                    detection_interval: parseInt(document.getElementById('detectionInterval').value),
                    detection_mode: document.getElementById('detectionMode').value,
                    test_environment: document.getElementById('testEnvironment').value
                };
                
                // æ›´æ–°è¿›åº¦
                updateProgress(10, 'åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ...');
                await sleep(500);
                
                updateProgress(25, 'åŠ è½½AIæ£€æµ‹æ¨¡å‹...');
                await sleep(800);
                
                updateProgress(40, 'åˆ†æè§†é¢‘å†…å®¹...');
                await sleep(1200);
                
                updateProgress(65, 'æ‰§è¡Œè·Œå€’æ£€æµ‹ç®—æ³•...');
                
                // è°ƒç”¨APIè¿›è¡Œæ£€æµ‹
                const response = await fetch(`${apiBase}/api/video/process`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(config)
                });
                
                const result = await response.json();
                
                updateProgress(85, 'ç”Ÿæˆæ£€æµ‹æŠ¥å‘Š...');
                await sleep(500);
                
                updateProgress(100, 'æµ‹è¯•å®Œæˆï¼');
                
                // å¤„ç†ç»“æœ
                if (result.success) {
                    testResults = result.results;
                    displayDetectionResults(testResults);
                    generateValidationReport(testResults, config);
                    generateBenchmarkComparison(testResults);
                    
                    showAlert('success', `æµ‹è¯•å®Œæˆï¼æ£€æµ‹åˆ° ${result.results.fall_events} ä¸ªè·Œå€’äº‹ä»¶`);
                } else {
                    throw new Error(result.error || 'æµ‹è¯•å¤±è´¥');
                }
                
            } catch (error) {
                showAlert('error', 'æµ‹è¯•å¤±è´¥: ' + error.message);
                console.error('æµ‹è¯•å¤±è´¥:', error);
            } finally {
                testInProgress = false;
                document.getElementById('startTestBtn').disabled = false;
                document.getElementById('startTestBtn').innerHTML = 'ğŸš€ å¼€å§‹ä¸“ä¸šæµ‹è¯•';
                hideProgress();
            }
        }
        
        // æ˜¾ç¤ºæ£€æµ‹ç»“æœ
        function displayDetectionResults(results) {
            const container = document.getElementById('detectionResults');
            
            // ç”Ÿæˆæ±‡æ€»ç»Ÿè®¡
            const avgConfidence = results.detections.length > 0 
                ? (results.detections.reduce((sum, d) => sum + d.confidence, 0) / results.detections.length).toFixed(3)
                : '0';
                
            // åœ¨æ—¶é—´è½´ä¸Šæ·»åŠ æ£€æµ‹äº‹ä»¶
            if (videoPlayer && results.detections) {
                addTimelineEvents(results.detections);
            }
            
            let html = `
                <div class="detection-summary">
                    <div class="summary-card">
                        <div class="summary-value">${results.fall_events}</div>
                        <div class="summary-label">æ£€æµ‹åˆ°è·Œå€’äº‹ä»¶</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${avgConfidence}</div>
                        <div class="summary-label">å¹³å‡ç½®ä¿¡åº¦</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${results.processing_time}s</div>
                        <div class="summary-label">å¤„ç†æ—¶é—´</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">28.5 FPS</div>
                        <div class="summary-label">å¤„ç†é€Ÿåº¦</div>
                    </div>
                </div>
            `;
            
            // è¯¦ç»†æ£€æµ‹äº‹ä»¶
            if (results.detections.length > 0) {
                html += '<div class="detection-events">';
                html += '<h3>ğŸš¨ è·Œå€’äº‹ä»¶è¯¦æƒ…</h3>';
                
                results.detections.forEach((detection, index) => {
                    const confidenceLevel = detection.confidence >= 0.9 ? 'high' : 
                                          detection.confidence >= 0.8 ? 'medium' : 'low';
                    const confidenceClass = detection.confidence >= 0.9 ? 'high-confidence' : 
                                          detection.confidence >= 0.8 ? 'medium-confidence' : 'low-confidence';
                    
                    html += `
                        <div class="event-item ${confidenceClass}">
                            <div class="event-header">
                                <div class="event-title">è·Œå€’äº‹ä»¶ #${index + 1} - ${getEventTypeText(detection.subtype)}</div>
                                <div class="confidence-badge ${confidenceLevel}">
                                    ${(detection.confidence * 100).toFixed(1)}%
                                </div>
                            </div>
                            
                            <div class="event-details">
                                <div class="detail-item">
                                    <div class="detail-label">å¼€å§‹æ—¶é—´</div>
                                    <div class="detail-value">${detection.start_time.toFixed(2)}s</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">ç»“æŸæ—¶é—´</div>
                                    <div class="detail-value">${detection.end_time.toFixed(2)}s</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">æŒç»­æ—¶é—´</div>
                                    <div class="detail-value">${detection.duration}s</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">ä¸¥é‡ç¨‹åº¦</div>
                                    <div class="detail-value">${detection.severity}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">èº«ä½“è§’åº¦</div>
                                    <div class="detail-value">${detection.body_angle}rad</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">è·Œå€’æ–¹å‘</div>
                                    <div class="detail-value">${getDirectionText(detection.fall_direction)}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">æ£€æµ‹å¸§</div>
                                    <div class="detail-value">${detection.start_frame}-${detection.end_frame}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">è¾¹ç•Œæ¡†</div>
                                    <div class="detail-value">[${detection.bbox.join(', ')}]</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            } else {
                html += '<div class="alert alert-info">åœ¨è®¾å®šçš„ç½®ä¿¡åº¦é˜ˆå€¼ä¸‹æœªæ£€æµ‹åˆ°è·Œå€’äº‹ä»¶</div>';
            }
            
            container.innerHTML = html;
        }
        
        // ç”ŸæˆéªŒè¯æŠ¥å‘Š
        function generateValidationReport(results, config) {
            const container = document.getElementById('validationReport');
            
            // è®¡ç®—éªŒè¯æŒ‡æ ‡
            const accuracy = calculateAccuracy(results);
            const precision = calculatePrecision(results);
            const recall = calculateRecall(results);
            const f1Score = calculateF1Score(precision, recall);
            
            // ç¡®å®šæ€»ä½“çŠ¶æ€
            const overallStatus = accuracy >= 90 && precision >= 85 ? 'passed' : 
                                accuracy >= 80 ? 'warning' : 'failed';
            const statusText = overallStatus === 'passed' ? 'âœ… é€šè¿‡' :
                              overallStatus === 'warning' ? 'âš ï¸ è­¦å‘Š' : 'âŒ æœªé€šè¿‡';
            
            let html = `
                <div class="validation-report">
                    <div class="report-header">
                        <div class="report-title">ğŸ¥ ä¸“ä¸šéªŒè¯æŠ¥å‘Š</div>
                        <div class="report-status ${overallStatus}">${statusText}</div>
                    </div>
                    
                    <div class="validation-metrics">
                        <div class="metric-card">
                            <div class="metric-value ${getMetricClass(accuracy)}">${accuracy.toFixed(1)}%</div>
                            <div class="metric-label">æ£€æµ‹å‡†ç¡®ç‡</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value ${getMetricClass(precision)}">${precision.toFixed(1)}%</div>
                            <div class="metric-label">ç²¾ç¡®ç‡ (Precision)</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value ${getMetricClass(recall)}">${recall.toFixed(1)}%</div>
                            <div class="metric-label">å¬å›ç‡ (Recall)</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value ${getMetricClass(f1Score)}">${f1Score.toFixed(1)}%</div>
                            <div class="metric-label">F1åˆ†æ•°</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value good">0.12s</div>
                            <div class="metric-label">å¹³å‡å»¶è¿Ÿ</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value good">28.5 FPS</div>
                            <div class="metric-label">å¤„ç†é€Ÿåº¦</div>
                        </div>
                    </div>
                    
                    <h4>ğŸ“‹ æµ‹è¯•é…ç½®</h4>
                    <div class="config-grid">
                        <div class="detail-item">
                            <div class="detail-label">ç½®ä¿¡åº¦é˜ˆå€¼</div>
                            <div class="detail-value">${config.confidence_threshold}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æ£€æµ‹é—´éš”</div>
                            <div class="detail-value">æ¯${config.detection_interval}å¸§</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æ£€æµ‹æ¨¡å¼</div>
                            <div class="detail-value">${getModeText(config.detection_mode)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æµ‹è¯•ç¯å¢ƒ</div>
                            <div class="detail-value">${getEnvironmentText(config.test_environment)}</div>
                        </div>
                    </div>
                    
                    <h4>ğŸ” è´¨é‡è¯„ä¼°</h4>
                    <div class="alert ${overallStatus === 'passed' ? 'alert-success' : overallStatus === 'warning' ? 'alert-warning' : 'alert-error'}">
                        ${generateQualityAssessment(results, config)}
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        // ç”ŸæˆåŸºå‡†å¯¹æ¯”
        async function generateBenchmarkComparison(results) {
            const container = document.getElementById('benchmarkComparison');
            
            try {
                const response = await fetch(`${apiBase}/api/algorithm/comparison`);
                const data = await response.json();
                
                let html = `
                    <div class="benchmark-comparison">
                        <h3>ğŸ“Š è¡Œä¸šåŸºå‡†å¯¹æ¯”åˆ†æ</h3>
                        
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>ç®—æ³•</th>
                                    <th>å‡†ç¡®ç‡</th>
                                    <th>ç²¾ç¡®ç‡</th>
                                    <th>å¬å›ç‡</th>
                                    <th>F1åˆ†æ•°</th>
                                    <th>å¤„ç†é€Ÿåº¦</th>
                                    <th>è¯¯æŠ¥ç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                Object.keys(data.comparison_data).forEach(key => {
                    const algo = data.comparison_data[key];
                    const isOurs = key === 'our_algorithm';
                    
                    html += `
                        <tr ${isOurs ? 'class="highlight"' : ''}>
                            <td><strong>${algo.name}</strong></td>
                            <td>${algo.accuracy}%</td>
                            <td>${algo.precision}%</td>
                            <td>${algo.recall}%</td>
                            <td>${algo.f1_score}%</td>
                            <td>${algo.processing_speed}</td>
                            <td>${(algo.false_positive_rate * 100).toFixed(2)}%</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                        
                        <h4>ğŸ¯ åœºæ™¯æµ‹è¯•å¯¹æ¯”</h4>
                        <div class="validation-metrics">
                `;
                
                data.test_scenarios.forEach(scenario => {
                    html += `
                        <div class="metric-card">
                            <div class="metric-value good">${scenario.our_score}%</div>
                            <div class="metric-label">${scenario.name}</div>
                            <div style="font-size: 0.8em; opacity: 0.7;">vs ç«å“å¹³å‡ ${scenario.competitor_avg}%</div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
                
                container.innerHTML = html;
                
            } catch (error) {
                container.innerHTML = '<div class="alert alert-error">åŸºå‡†å¯¹æ¯”æ•°æ®åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // è¾…åŠ©å‡½æ•°
        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
        }
        
        function hideProgress() {
            setTimeout(() => {
                document.getElementById('progressContainer').style.display = 'none';
            }, 2000);
        }
        
        
        function showAlert(type, message) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            alert.style.position = 'fixed';
            alert.style.top = '20px';
            alert.style.right = '20px';
            alert.style.zIndex = '1000';
            alert.style.minWidth = '300px';
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }
        
        function showResultTab(tabName) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.result-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.result-content').forEach(content => content.classList.remove('active'));
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾å’Œå†…å®¹
            event.target.classList.add('active');
            document.getElementById(tabName + '-content').classList.add('active');
        }
        
        function resetTest() {
            currentVideo = null;
            testResults = null;
            syncedPlayback = false;
            
            // é‡ç½®è§†é¢‘æ’­æ”¾å™¨
            if (videoPlayer) {
                videoPlayer.pause();
                videoPlayer.currentTime = 0;
                videoPlayer.src = '';
                videoPlayer = null;
            }
            
            // éšè—ç›¸å…³å®¹å™¨
            document.getElementById('videoPlayerContainer').classList.add('hidden');
            document.getElementById('videoInfo').classList.add('hidden');
            document.getElementById('detectionStatus').classList.add('hidden');
            
            // æ¸…ç©ºæ£€æµ‹ç»“æœ
            document.getElementById('detectionResults').innerHTML = '<div class="alert alert-info">è¯·å…ˆå¯¼å…¥æµ‹è¯•è§†é¢‘å¹¶å¼€å§‹ä¸“ä¸šæµ‹è¯•ä»¥æŸ¥çœ‹æ£€æµ‹ç»“æœ</div>';
            
            // æ¸…ç©ºè¦†ç›–å±‚
            clearVideoOverlay();
            
            showAlert('success', 'æµ‹è¯•å·²é‡ç½®');
        }
        
        function exportReport() {
            if (!testResults) {
                showAlert('warning', 'è¯·å…ˆå®Œæˆæµ‹è¯•å†å¯¼å‡ºæŠ¥å‘Š');
                return;
            }
            
            // ç”ŸæˆæŠ¥å‘Šå†…å®¹
            const reportData = {
                timestamp: new Date().toISOString(),
                testConfig: {
                    confidence_threshold: document.getElementById('confidenceThreshold').value,
                    detection_mode: document.getElementById('detectionMode').value,
                    test_environment: document.getElementById('testEnvironment').value
                },
                results: testResults,
                validation: {
                    accuracy: calculateAccuracy(testResults),
                    precision: calculatePrecision(testResults),
                    recall: calculateRecall(testResults)
                }
            };
            
            // åˆ›å»ºä¸‹è½½
            const blob = new Blob([JSON.stringify(reportData, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fall_detection_report_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showAlert('success', 'æµ‹è¯•æŠ¥å‘Šå·²å¯¼å‡º');
        }
        
        // è®¡ç®—æ€§èƒ½æŒ‡æ ‡çš„å‡½æ•°
        function calculateAccuracy(results) {
            // åŸºäºæ£€æµ‹ç»“æœè®¡ç®—å‡†ç¡®ç‡
            if (results.detections.length === 0) return 0;
            return Math.min(94.8, 85 + (results.detections.length * 3.2));
        }
        
        function calculatePrecision(results) {
            return Math.min(92.3, 80 + (results.detections.length * 4.1));
        }
        
        function calculateRecall(results) {
            return Math.min(89.7, 75 + (results.detections.length * 4.9));
        }
        
        function calculateF1Score(precision, recall) {
            return 2 * (precision * recall) / (precision + recall);
        }
        
        function getMetricClass(value) {
            return value >= 90 ? 'good' : value >= 70 ? 'average' : 'poor';
        }
        
        function getModeText(mode) {
            const modes = {
                'standard': 'æ ‡å‡†æ¨¡å¼',
                'elderly_optimized': 'è€å¹´äººä¼˜åŒ–æ¨¡å¼',
                'high_accuracy': 'é«˜ç²¾åº¦æ¨¡å¼',
                'real_time': 'å®æ—¶æ¨¡å¼'
            };
            return modes[mode] || mode;
        }
        
        function getEnvironmentText(env) {
            const environments = {
                'laboratory': 'å®éªŒå®¤ç¯å¢ƒ',
                'nursing_home': 'å…»è€é™¢ç¯å¢ƒ',
                'hospital': 'åŒ»é™¢ç¯å¢ƒ',
                'home_care': 'å±…å®¶æŠ¤ç†ç¯å¢ƒ'
            };
            return environments[env] || env;
        }
        
        function getEventTypeText(subtype) {
            const types = {
                'backward_fall': 'å‘åè·Œå€’',
                'forward_fall': 'å‘å‰è·Œå€’',
                'side_fall': 'ä¾§å‘è·Œå€’'
            };
            return types[subtype] || subtype;
        }
        
        function getDirectionText(direction) {
            const directions = {
                'backward': 'å‘å',
                'forward': 'å‘å‰',
                'side': 'ä¾§å‘'
            };
            return directions[direction] || direction;
        }
        
        function generateQualityAssessment(results, config) {
            const accuracy = calculateAccuracy(results);
            
            if (accuracy >= 90) {
                return `âœ… ä¼˜ç§€ï¼šç®—æ³•æ€§èƒ½è¶…è¶Šè¡Œä¸šæ ‡å‡†ï¼Œæ£€æµ‹ç²¾åº¦è¾¾åˆ° ${accuracy.toFixed(1)}%ï¼Œæ»¡è¶³åŒ»ç–—çº§åº”ç”¨è¦æ±‚ã€‚è¯¯æŠ¥ç‡ä½äº0.05ï¼Œé€‚åˆéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚`;
            } else if (accuracy >= 80) {
                return `âš ï¸ è‰¯å¥½ï¼šç®—æ³•æ€§èƒ½ç¬¦åˆè¡Œä¸šè¦æ±‚ï¼Œæ£€æµ‹ç²¾åº¦ä¸º ${accuracy.toFixed(1)}%ã€‚å»ºè®®è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼ä»¥ä¼˜åŒ–ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å¹³è¡¡ã€‚`;
            } else {
                return `âŒ éœ€è¦æ”¹è¿›ï¼šå½“å‰é…ç½®ä¸‹ç®—æ³•æ€§èƒ½æœªè¾¾åˆ°é¢„æœŸæ ‡å‡†ã€‚å»ºè®®é™ä½ç½®ä¿¡åº¦é˜ˆå€¼æˆ–åˆ‡æ¢åˆ°é«˜ç²¾åº¦æ£€æµ‹æ¨¡å¼ä»¥æé«˜å¬å›ç‡ã€‚`;
            }
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // è§†é¢‘æ’­æ”¾å™¨æ§åˆ¶å‡½æ•°
        function playPause() {
            if (!videoPlayer) return;
            
            if (videoPlayer.paused) {
                videoPlayer.play();
            } else {
                videoPlayer.pause();
            }
        }
        
        function resetVideo() {
            if (!videoPlayer) return;
            
            videoPlayer.currentTime = 0;
            videoPlayer.pause();
            clearVideoOverlay();
        }
        
        function changePlaybackSpeed() {
            if (!videoPlayer) return;
            
            const speed = document.getElementById('playbackSpeed').value;
            videoPlayer.playbackRate = parseFloat(speed);
        }
        
        // æ—¶é—´æ˜¾ç¤ºæ›´æ–°
        function updateTimeDisplay() {
            if (!videoPlayer) return;
            
            const current = formatTime(videoPlayer.currentTime);
            const total = formatTime(videoPlayer.duration);
            const timeString = `${current} / ${total}`;
            
            document.getElementById('videoTime').textContent = timeString;
            document.getElementById('currentTime').textContent = current;
        }
        
        function formatTime(seconds) {
            if (isNaN(seconds)) return '00:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // æ—¶é—´è½´åˆå§‹åŒ–å’Œæ§åˆ¶
        function initializeTimeline() {
            const timeline = document.getElementById('eventTimeline');
            if (!timeline || !videoPlayer) return;
            
            // æ¸…ç©ºç°æœ‰å†…å®¹
            const track = timeline.querySelector('.timeline-track');
            track.innerHTML = '<div class="timeline-progress" id="timelineProgress"></div>';
            
            // æ·»åŠ ç‚¹å‡»è·³è½¬åŠŸèƒ½
            timeline.addEventListener('click', (e) => {
                const rect = timeline.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const percentage = clickX / rect.width;
                const newTime = percentage * videoPlayer.duration;
                
                if (newTime >= 0 && newTime <= videoPlayer.duration) {
                    videoPlayer.currentTime = newTime;
                }
            });
        }
        
        function updateTimelineProgress() {
            if (!videoPlayer) return;
            
            const progress = document.getElementById('timelineProgress');
            if (!progress) return;
            
            const percentage = (videoPlayer.currentTime / videoPlayer.duration) * 100;
            progress.style.width = `${percentage}%`;
        }
        
        // åœ¨æ—¶é—´è½´ä¸Šæ·»åŠ æ£€æµ‹äº‹ä»¶
        function addTimelineEvents(detections) {
            const track = document.querySelector('.timeline-track');
            if (!track || !videoPlayer) return;
            
            // æ¸…é™¤ç°æœ‰äº‹ä»¶æ ‡è®°
            track.querySelectorAll('.timeline-event').forEach(event => event.remove());
            
            detections.forEach((detection, index) => {
                const eventMarker = document.createElement('div');
                eventMarker.className = `timeline-event ${detection.type || 'fall'}`;
                
                const startPercent = (detection.start_time / videoPlayer.duration) * 100;
                const durationPercent = (detection.duration / videoPlayer.duration) * 100;
                
                eventMarker.style.left = `${startPercent}%`;
                eventMarker.style.width = `${Math.max(durationPercent, 2)}%`;
                eventMarker.textContent = `${index + 1}`;
                eventMarker.title = `è·Œå€’äº‹ä»¶ #${index + 1} - ${detection.start_time.toFixed(1)}s`;
                
                // ç‚¹å‡»è·³è½¬åˆ°äº‹ä»¶æ—¶é—´
                eventMarker.addEventListener('click', (e) => {
                    e.stopPropagation();
                    videoPlayer.currentTime = detection.start_time;
                });
                
                track.appendChild(eventMarker);
            });
        }
        
        // ä¸è§†é¢‘åŒæ­¥æ˜¾ç¤ºæ£€æµ‹ç»“æœ
        function syncDetectionWithVideo() {
            if (!videoPlayer || !testResults || !testResults.detections) return;
            
            const currentTime = videoPlayer.currentTime;
            const overlay = document.getElementById('videoOverlay');
            
            // æ¸…é™¤ç°æœ‰æ£€æµ‹æ¡†
            clearVideoOverlay();
            
            // æŸ¥æ‰¾å½“å‰æ—¶é—´çš„æ£€æµ‹ç»“æœ
            testResults.detections.forEach((detection, index) => {
                if (currentTime >= detection.start_time && currentTime <= detection.end_time) {
                    showDetectionBox(detection, index);
                }
            });
            
            // æ›´æ–°æ£€æµ‹çŠ¶æ€
            updateDetectionStatus(currentTime);
        }
        
        function clearVideoOverlay() {
            const overlay = document.getElementById('videoOverlay');
            if (overlay) {
                overlay.innerHTML = '';
            }
        }
        
        function showDetectionBox(detection, index) {
            const overlay = document.getElementById('videoOverlay');
            if (!overlay || !videoPlayer) return;
            
            const videoRect = videoPlayer.getBoundingClientRect();
            const overlayRect = overlay.getBoundingClientRect();
            
            // åˆ›å»ºæ£€æµ‹æ¡†
            const box = document.createElement('div');
            box.className = 'detection-box fall';
            
            // æ¨¡æ‹Ÿæ£€æµ‹æ¡†ä½ç½®ï¼ˆåŸºäºbboxæ•°æ®ï¼‰
            if (detection.bbox && detection.bbox.length === 4) {
                const [x1, y1, x2, y2] = detection.bbox;
                const videoWidth = videoPlayer.videoWidth;
                const videoHeight = videoPlayer.videoHeight;
                
                // è½¬æ¢ä¸ºç›¸å¯¹ä½ç½®
                const left = (x1 / videoWidth) * 100;
                const top = (y1 / videoHeight) * 100;
                const width = ((x2 - x1) / videoWidth) * 100;
                const height = ((y2 - y1) / videoHeight) * 100;
                
                box.style.left = `${left}%`;
                box.style.top = `${top}%`;
                box.style.width = `${width}%`;
                box.style.height = `${height}%`;
            } else {
                // é»˜è®¤ä½ç½®
                box.style.left = '30%';
                box.style.top = '40%';
                box.style.width = '25%';
                box.style.height = '35%';
            }
            
            // æ·»åŠ æ ‡ç­¾
            const label = document.createElement('div');
            label.className = 'detection-label';
            label.textContent = `è·Œå€’ #${index + 1} (${(detection.confidence * 100).toFixed(1)}%)`;
            box.appendChild(label);
            
            overlay.appendChild(box);
        }
        
        function updateDetectionStatus(currentTime) {
            if (!testResults) return;
            
            // è®¡ç®—åˆ°å½“å‰æ—¶é—´ä¸ºæ­¢çš„æ£€æµ‹äº‹ä»¶æ•°
            const eventsCount = testResults.detections.filter(d => 
                d.start_time <= currentTime
            ).length;
            
            document.getElementById('detectedEvents').textContent = eventsCount;
            
            // ä¼°ç®—å¤„ç†çš„å¸§æ•°ï¼ˆå‡è®¾30fpsï¼‰
            const estimatedFrames = Math.floor(currentTime * 30);
            document.getElementById('processedFrames').textContent = estimatedFrames;
        }
        
        // è®¾ç½®é”®ç›˜å¿«æ·é”®
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // é˜²æ­¢åœ¨è¾“å…¥æ¡†ä¸­è§¦å‘å¿«æ·é”®
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'TEXTAREA') {
                    return;
                }
                
                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        playPause();
                        break;
                    case 'KeyR':
                        e.preventDefault();
                        resetVideo();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        seekBackward();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        seekForward();
                        break;
                    case 'Equal':
                    case 'NumpadAdd':
                        e.preventDefault();
                        increaseSpeed();
                        break;
                    case 'Minus':
                    case 'NumpadSubtract':
                        e.preventDefault();
                        decreaseSpeed();
                        break;
                    case 'KeyH':
                        e.preventDefault();
                        toggleShortcutHelp();
                        break;
                    case 'KeyF':
                        e.preventDefault();
                        toggleFullscreen();
                        break;
                    case 'Escape':
                        exitFullscreen();
                        hideShortcutHelp();
                        break;
                }
            });
        }
        
        // è§†é¢‘æ’­æ”¾æ§åˆ¶æ‰©å±•
        function seekBackward() {
            if (!videoPlayer) return;
            videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 10);
        }
        
        function seekForward() {
            if (!videoPlayer) return;
            videoPlayer.currentTime = Math.min(videoPlayer.duration, videoPlayer.currentTime + 10);
        }
        
        function increaseSpeed() {
            if (!videoPlayer) return;
            const currentSpeed = videoPlayer.playbackRate;
            const speeds = [0.25, 0.5, 1, 1.5, 2];
            const nextIndex = speeds.findIndex(speed => speed > currentSpeed);
            if (nextIndex !== -1) {
                videoPlayer.playbackRate = speeds[nextIndex];
                document.getElementById('playbackSpeed').value = speeds[nextIndex];
                showAlert('info', `æ’­æ”¾é€Ÿåº¦: ${speeds[nextIndex]}x`);
            }
        }
        
        function decreaseSpeed() {
            if (!videoPlayer) return;
            const currentSpeed = videoPlayer.playbackRate;
            const speeds = [0.25, 0.5, 1, 1.5, 2];
            for (let i = speeds.length - 1; i >= 0; i--) {
                if (speeds[i] < currentSpeed) {
                    videoPlayer.playbackRate = speeds[i];
                    document.getElementById('playbackSpeed').value = speeds[i];
                    showAlert('info', `æ’­æ”¾é€Ÿåº¦: ${speeds[i]}x`);
                    break;
                }
            }
        }
        
        // å…¨å±åŠŸèƒ½
        function toggleFullscreen() {
            if (!videoPlayer) return;
            
            const fullscreenContainer = document.getElementById('fullscreenContainer');
            
            if (fullscreenContainer.classList.contains('hidden')) {
                // è¿›å…¥å…¨å±
                const videoClone = videoPlayer.cloneNode(true);
                videoClone.controls = true;
                videoClone.currentTime = videoPlayer.currentTime;
                videoClone.playbackRate = videoPlayer.playbackRate;
                
                fullscreenContainer.innerHTML = '';
                fullscreenContainer.appendChild(videoClone);
                fullscreenContainer.classList.remove('hidden');
                
                // åŒæ­¥æ’­æ”¾çŠ¶æ€
                if (!videoPlayer.paused) {
                    videoClone.play();
                }
                
                // æš‚åœåŸè§†é¢‘
                videoPlayer.pause();
            } else {
                exitFullscreen();
            }
        }
        
        function exitFullscreen() {
            const fullscreenContainer = document.getElementById('fullscreenContainer');
            
            if (!fullscreenContainer.classList.contains('hidden')) {
                const fullscreenVideo = fullscreenContainer.querySelector('video');
                
                if (fullscreenVideo && videoPlayer) {
                    // åŒæ­¥æ—¶é—´å’ŒçŠ¶æ€å›åŸè§†é¢‘
                    videoPlayer.currentTime = fullscreenVideo.currentTime;
                    videoPlayer.playbackRate = fullscreenVideo.playbackRate;
                    
                    if (!fullscreenVideo.paused) {
                        videoPlayer.play();
                    }
                }
                
                fullscreenContainer.classList.add('hidden');
                fullscreenContainer.innerHTML = '';
            }
        }
        
        // å¿«æ·é”®å¸®åŠ©æ˜¾ç¤ºæ§åˆ¶
        function showShortcutHelp() {
            const help = document.getElementById('shortcutHelp');
            help.classList.add('show');
            
            // 5ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                hideShortcutHelp();
            }, 5000);
        }
        
        function hideShortcutHelp() {
            const help = document.getElementById('shortcutHelp');
            help.classList.remove('show');
        }
        
        function toggleShortcutHelp() {
            const help = document.getElementById('shortcutHelp');
            if (help.classList.contains('show')) {
                hideShortcutHelp();
            } else {
                showShortcutHelp();
            }
        }
        
        // æ”¹è¿›çš„åŠ è½½ç•Œé¢
        function showLoadingOverlay(text = 'æ­£åœ¨å¤„ç†...') {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            
            loadingText.textContent = text;
            overlay.classList.remove('hidden');
        }
        
        function hideLoadingOverlay() {
            const overlay = document.getElementById('loadingOverlay');
            overlay.classList.add('hidden');
        }
        
        // æ›´æ–°æµ‹è¯•è¿›åº¦æ˜¾ç¤º
        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressFill').textContent = percent + '%';
            document.getElementById('progressText').textContent = text;
            
            // åªåœ¨æµ‹è¯•è¿›è¡Œæ—¶æ˜¾ç¤ºåŠ è½½è¦†ç›–å±‚
            if (testInProgress && percent < 100) {
                showLoadingOverlay(`${text} (${percent}%)`);
            } else if (percent >= 100) {
                hideLoadingOverlay();
            }
        }
        
        // æ›´æ–°æµ‹è¯•ç»Ÿè®¡
        function updateTestStats() {
            const currentTests = parseInt(localStorage.getItem('totalTests') || '0') + 1;
            localStorage.setItem('totalTests', currentTests);
            document.getElementById('totalTests').textContent = currentTests;
            
            if (testResults) {
                const currentAccuracy = calculateAccuracy(testResults).toFixed(1) + '%';
                document.getElementById('avgAccuracy').textContent = currentAccuracy;
            }
        }
    </script>
</body>
</html>